<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>New auto</title>
</head>
<body>
<script>
    let input = $('.btn-block');

    // Заменяем на button c сохранением всех атрибутов
    input.replaceWith(
        $('<button />')
            .attr(input.attr())
            .text(input.val())
    );

    $(document).ready(function() {
        $('#firm_id').change(function()
        {   getModels();
        });
    });
    $(document).ready(function() {
        $('#firm').change(function() {
            var firmId = $(this).children(":selected").attr("id");
            console.log(firmId)
            $('#model').empty();

            $.get('/model/' + firmId, function(data) {
                $.each(data, function(index, model) {
                    $('#modelDropdown').append($('').text(model.name).val(model.id)); }); }); }); });

</script>

<div class="container">
    <h3> Добавить новый авто</h3>
    <form th:method="POST" th:action="@{/autos}" th:object="${auto}" enctype="multipart/form-data">

        <!--    <label  for="brand">Марка автомобиля: </label>-->
        <!--    <input type="text" th:field="*{brand}" id="brand"/>-->

        <div class="form-group">
            <label  for="firm">Марка автомобиля: </label>
            <select th:field="*{brand}" id="firm">
                <option th:each="firm:${firms}"
                        th:value="${firm.getName()}" th:text="${firm.getName()}" th:id="${firm.getId()}">

                </option>
            </select>
            <div style="color: red" th:if="${#fields.hasErrors('brand')}" th:errors="*{brand}">Brand error</div>
        </div>
        <div>
        <div class="form-group">
            <label  for="model">Модель автомобиля: </label>
            <select th:field="*{model}" id="model">
                <option th:each="model:${models}"
                        th:value="${model.getName()}" th:text="${model.getName()}">

                </option>
            </select>
<!--            <label for="model">Модель автомобиля: </label>-->
<!--            <input class="form-control" type="text" th:field="*{model}" id="model"/>-->
            <div style="color: red" th:if="${#fields.hasErrors('model')}" th:errors="*{model}">Model error</div>
        </div>

        <div class="form-group">
            <label for="licensePlate">Номерной знак автомобиля: </label>
            <input class="form-control" type="text" th:field="*{licensePlate}" id="licensePlate"/>
            <div style="color: red" th:if="${#fields.hasErrors('licensePlate')}" th:errors="*{licensePlate}">License
                plate
                error
            </div>
        </div>

        <div class="form-group">
            <label for="yearOfIssue">Год выпуска: </label>
            <input class="form-control" type="text" th:field="*{yearOfIssue}" id="yearOfIssue"/>
            <div style="color: red" th:if="${#fields.hasErrors('yearOfIssue')}" th:errors="*{yearOfIssue}"> yearOfIssue
                error
            </div>
        </div>

        <div class="form-group">
            <label for="vinNumber">VIN номер: </label>
            <input class="form-control" type="text" th:field="*{vinNumber}" id="vinNumber"/>
            <div style="color: red" th:if="${#fields.hasErrors('vinNumber')}" th:errors="*{vinNumber}"> Vin number
                error
            </div>
        </div>

        <div class="form-group">
            <label for="mileage">Пробег: </label>
            <input class="form-control" type="number" th:field="*{mileage}" id="mileage"/>
        </div>

        <p><input type="file" name="photo" required multiple title="Загрузите одну или несколько фотографий">

        </p>
        <!--    Первая фотография: <input type="file" name="file1"><br/><br/>-->
        <!--    Вторая фотография: <input type="file" name="file2"><br/><br/>-->
        <!--    Третья фотография: <input type="file" name="file3"><br/><br/>-->


        <input class="btn-block" type="submit" value="Добавить авто"/>
    </form>
    <hr>
    <a th:href="@{/autos}">На главную страницу </a><br/><br/>
</div>
</body>
</html>